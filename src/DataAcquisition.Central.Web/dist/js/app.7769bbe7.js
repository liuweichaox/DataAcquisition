(()=>{"use strict";var e={1133(e,n,r){r(3792),r(3362),r(9085),r(9391);var l=r(5130),t=r(9258),a=r(6768),o={class:"nav"},s={class:"main"};function u(e,n){var r=(0,a.g2)("router-link"),l=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("nav",o,[(0,a.bF)(r,{to:"/edges"},{default:(0,a.k6)(function(){return(0,t.A)(n[0]||(n[0]=[(0,a.eW)("Edges",-1)]))}),_:1}),(0,a.bF)(r,{to:"/metrics"},{default:(0,a.k6)(function(){return(0,t.A)(n[1]||(n[1]=[(0,a.eW)("Metrics",-1)]))}),_:1}),(0,a.bF)(r,{to:"/logs"},{default:(0,a.k6)(function(){return(0,t.A)(n[2]||(n[2]=[(0,a.eW)("Logs",-1)]))}),_:1}),n[3]||(n[3]=(0,a.Lk)("a",{href:"/metrics",target:"_blank",rel:"noreferrer"},"Central /metrics (raw)",-1))]),(0,a.Lk)("main",s,[(0,a.bF)(l)])])}var i=r(1241);const c={},d=(0,i.A)(c,[["render",u],["__scopeId","data-v-9e495b48"]]),p=d;var v=r(8728),k=r(4232),g={class:"page"},L={class:"header"},f=["disabled"],h={key:0,class:"error"},m={key:1,class:"table"},b={class:"errcell"},y={key:2,class:"empty"};function w(e,n,r,l,t,o){return(0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("header",L,[n[1]||(n[1]=(0,a.Lk)("h1",null,"边缘节点（edge_id）",-1)),(0,a.Lk)("button",{onClick:n[0]||(n[0]=function(){return o.load&&o.load.apply(o,arguments)}),disabled:t.loading},(0,k.v_)(t.loading?"刷新中...":"刷新"),9,f)]),n[3]||(n[3]=(0,a.Lk)("p",{class:"hint"},[(0,a.eW)(" 后端："),(0,a.Lk)("code",null,"DataAcquisition.Central.Api"),(0,a.eW)("（默认 "),(0,a.Lk)("code",null,"http://localhost:8000"),(0,a.eW)("）； 前端 devServer 通过代理访问 "),(0,a.Lk)("code",null,"/api"),(0,a.eW)("。 ")],-1)),t.error?((0,a.uX)(),(0,a.CE)("p",h,(0,k.v_)(t.error),1)):(0,a.Q3)("",!0),t.edges.length?((0,a.uX)(),(0,a.CE)("table",m,[n[2]||(n[2]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"edge_id"),(0,a.Lk)("th",null,"hostname"),(0,a.Lk)("th",null,"version"),(0,a.Lk)("th",null,"last_seen_utc"),(0,a.Lk)("th",null,"buffer_backlog"),(0,a.Lk)("th",null,"last_error")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.edges,function(e){var n;return(0,a.uX)(),(0,a.CE)("tr",{key:e.edgeId},[(0,a.Lk)("td",null,[(0,a.Lk)("code",null,(0,k.v_)(e.edgeId),1)]),(0,a.Lk)("td",null,(0,k.v_)(e.hostname||"-"),1),(0,a.Lk)("td",null,(0,k.v_)(e.version||"-"),1),(0,a.Lk)("td",null,(0,k.v_)(e.lastSeenUtc),1),(0,a.Lk)("td",null,(0,k.v_)(null!==(n=e.bufferBacklog)&&void 0!==n?n:"-"),1),(0,a.Lk)("td",b,(0,k.v_)(e.lastError||"-"),1)])}),128))])])):t.loading||t.error?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("p",y,"暂无边缘节点（先调用 /api/edges/register 或 /api/edges/heartbeat）。"))])}var _=r(908),A=r(388);r(6280),r(6918),r(8706),r(6099);function C(e){return E.apply(this,arguments)}function E(){return E=(0,A.A)((0,_.A)().m(function e(n){var r,l;return(0,_.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,fetch(n,{headers:{Accept:"application/json"}});case 1:if(r=e.v,r.ok){e.n=3;break}return e.n=2,r.text()["catch"](function(){return""});case 2:throw l=e.v,new Error("HTTP ".concat(r.status," ").concat(r.statusText).concat(l?": ".concat(l):""));case 3:return e.n=4,r.json();case 4:return e.a(2,e.v)}},e)})),E.apply(this,arguments)}const X={name:"EdgesView",data:function(){return{edges:[],loading:!1,error:""}},mounted:function(){this.load()},methods:{load:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){var r;return(0,_.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return e.loading=!0,e.error="",n.p=1,n.n=2,C("/api/edges");case 2:e.edges=n.v,n.n=4;break;case 3:n.p=3,r=n.v,e.error=(null===r||void 0===r?void 0:r.message)||String(r);case 4:return n.p=4,e.loading=!1,n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}))()}}},W=(0,i.A)(X,[["render",w],["__scopeId","data-v-00fcc358"]]),S=W;var x={class:"page"},O={class:"header"},I={class:"actions"},P=["disabled"],Q={key:0,class:"error"},T={key:1,class:"meta"},j={key:2,class:"grid"},F={class:"k"},K={class:"small"},z={class:"pre"},V={key:3,class:"empty"};function U(e,n,r,l,t,o){return(0,a.uX)(),(0,a.CE)("div",x,[(0,a.Lk)("header",O,[n[2]||(n[2]=(0,a.Lk)("h1",null,"指标（Central API）",-1)),(0,a.Lk)("div",I,[(0,a.Lk)("button",{onClick:n[0]||(n[0]=function(){return o.load&&o.load.apply(o,arguments)}),disabled:t.loading},(0,k.v_)(t.loading?"刷新中...":"刷新"),9,P),n[1]||(n[1]=(0,a.Lk)("a",{class:"raw",href:"/metrics",target:"_blank",rel:"noreferrer"},"打开 /metrics 原始页",-1))])]),n[12]||(n[12]=(0,a.Lk)("p",{class:"hint"},[(0,a.eW)(" 数据源："),(0,a.Lk)("code",null,"/api/metrics-data"),(0,a.eW)("（由 Central API 从 "),(0,a.Lk)("code",null,"/metrics"),(0,a.eW)(" 解析为 JSON）。 ")],-1)),t.error?((0,a.uX)(),(0,a.CE)("p",Q,(0,k.v_)(t.error),1)):(0,a.Q3)("",!0),t.payload?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("div",null,[n[3]||(n[3]=(0,a.Lk)("b",null,"timestamp",-1)),n[4]||(n[4]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(t.payload.timestamp),1)]),(0,a.Lk)("div",null,[n[5]||(n[5]=(0,a.Lk)("b",null,"metrics keys",-1)),n[6]||(n[6]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(o.metricKeys.length),1)])])):(0,a.Q3)("",!0),t.payload?((0,a.uX)(),(0,a.CE)("div",j,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.metricKeys,function(e){var r,l,s,u,i;return(0,a.uX)(),(0,a.CE)("div",{key:e,class:"card"},[(0,a.Lk)("div",F,[(0,a.Lk)("code",null,(0,k.v_)(e),1)]),(0,a.Lk)("div",K,[(0,a.Lk)("div",null,[n[7]||(n[7]=(0,a.Lk)("b",null,"type",-1)),n[8]||(n[8]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(null!==(r=null===(l=t.payload.metrics)||void 0===l||null===(l=l[e])||void 0===l?void 0:l.type)&&void 0!==r?r:"-"),1)]),(0,a.Lk)("div",null,[n[9]||(n[9]=(0,a.Lk)("b",null,"data",-1)),n[10]||(n[10]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(null!==(s=null===(u=t.payload.metrics)||void 0===u||null===(u=u[e])||void 0===u||null===(u=u.data)||void 0===u?void 0:u.length)&&void 0!==s?s:0),1)])]),(0,a.Lk)("details",null,[n[11]||(n[11]=(0,a.Lk)("summary",null,"展开 JSON",-1)),(0,a.Lk)("pre",z,(0,k.v_)(o.pretty(null===(i=t.payload.metrics)||void 0===i?void 0:i[e])),1)])])}),128))])):t.loading||t.error?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("p",V,"暂无数据（确认 Central API 已启动）。"))])}r(6910),r(739),r(3110),r(9432);const J={name:"MetricsView",data:function(){return{payload:null,loading:!1,error:""}},computed:{metricKeys:function(){var e,n=Object.keys((null===(e=this.payload)||void 0===e?void 0:e.metrics)||{});return n.sort(),n}},mounted:function(){this.load()},methods:{pretty:function(e){return JSON.stringify(e,null,2)},load:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){var r;return(0,_.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return e.loading=!0,e.error="",n.p=1,n.n=2,C("/api/metrics-data");case 2:e.payload=n.v,n.n=4;break;case 3:n.p=3,r=n.v,e.error=(null===r||void 0===r?void 0:r.message)||String(r);case 4:return n.p=4,e.loading=!1,n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}))()}}},M=(0,i.A)(J,[["render",U],["__scopeId","data-v-c1ce7ada"]]),q=M;var N={class:"page"},D={class:"header"},B=["disabled"],H={class:"filters"},R={class:"f"},G=["value"],Y={class:"f"},Z={class:"f"},$=["disabled"],ee={key:0,class:"error"},ne={key:1,class:"meta"},re={key:2,class:"table"},le={class:"msg"},te={class:"m"},ae={key:0},oe={class:"pre"},se={key:3,class:"empty"},ue={key:4,class:"pager"},ie=["disabled"],ce=["disabled"];function de(e,n,r,o,s,u){return(0,a.uX)(),(0,a.CE)("div",N,[(0,a.Lk)("header",D,[n[7]||(n[7]=(0,a.Lk)("h1",null,"采集日志（Edge Agent）",-1)),(0,a.Lk)("button",{onClick:n[0]||(n[0]=function(){return u.load&&u.load.apply(u,arguments)}),disabled:s.loading},(0,k.v_)(s.loading?"刷新中...":"刷新"),9,B)]),n[20]||(n[20]=(0,a.Lk)("p",{class:"hint"},[(0,a.eW)(" 数据源："),(0,a.Lk)("code",null,"/edge/api/logs"),(0,a.eW)("（通过 devServer 代理到 "),(0,a.Lk)("code",null,"http://localhost:8001/api/logs"),(0,a.eW)("）。 ")],-1)),(0,a.Lk)("section",H,[(0,a.Lk)("label",R,[n[9]||(n[9]=(0,a.Lk)("span",null,"level",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":n[1]||(n[1]=function(e){return s.level=e})},[n[8]||(n[8]=(0,a.Lk)("option",{value:""},"(all)",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.levels,function(e){return(0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,k.v_)(e),9,G)}),128))],512),[[l.u1,s.level]])]),(0,a.Lk)("label",Y,[n[10]||(n[10]=(0,a.Lk)("span",null,"keyword",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":n[2]||(n[2]=function(e){return s.keyword=e}),placeholder:"模糊搜索（message/source/exception）"},null,512),[[l.Jo,s.keyword]])]),(0,a.Lk)("label",Z,[n[12]||(n[12]=(0,a.Lk)("span",null,"pageSize",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":n[3]||(n[3]=function(e){return s.pageSize=e})},(0,t.A)(n[11]||(n[11]=[(0,a.Lk)("option",{value:50},"50",-1),(0,a.Lk)("option",{value:100},"100",-1),(0,a.Lk)("option",{value:200},"200",-1)])),512),[[l.u1,s.pageSize,void 0,{number:!0}]])]),(0,a.Lk)("button",{onClick:n[4]||(n[4]=function(e){s.page=1,u.load()}),disabled:s.loading},"查询",8,$)]),s.error?((0,a.uX)(),(0,a.CE)("p",ee,(0,k.v_)(s.error),1)):(0,a.Q3)("",!0),s.resp?((0,a.uX)(),(0,a.CE)("div",ne,[(0,a.Lk)("div",null,[n[13]||(n[13]=(0,a.Lk)("b",null,"Total",-1)),n[14]||(n[14]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(s.resp.Total),1)]),(0,a.Lk)("div",null,[n[15]||(n[15]=(0,a.Lk)("b",null,"Page",-1)),n[16]||(n[16]=(0,a.eW)(": ",-1)),(0,a.Lk)("code",null,(0,k.v_)(s.resp.Page),1),n[17]||(n[17]=(0,a.eW)("/",-1)),(0,a.Lk)("code",null,(0,k.v_)(s.resp.TotalPages),1)])])):(0,a.Q3)("",!0),u.rows.length?((0,a.uX)(),(0,a.CE)("table",re,[n[19]||(n[19]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"time"),(0,a.Lk)("th",null,"level"),(0,a.Lk)("th",null,"source"),(0,a.Lk)("th",{style:{width:"55%"}},"message")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(u.rows,function(e,r){return(0,a.uX)(),(0,a.CE)("tr",{key:r},[(0,a.Lk)("td",null,[(0,a.Lk)("code",null,(0,k.v_)(e.timestamp||e.time||e.createdAt||"-"),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("code",null,(0,k.v_)(e.level||"-"),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("code",null,(0,k.v_)(e.sourceContext||e.source||"-"),1)]),(0,a.Lk)("td",le,[(0,a.Lk)("div",te,(0,k.v_)(e.message||e.renderedMessage||"-"),1),e.exception?((0,a.uX)(),(0,a.CE)("details",ae,[n[18]||(n[18]=(0,a.Lk)("summary",null,"exception",-1)),(0,a.Lk)("pre",oe,(0,k.v_)(e.exception),1)])):(0,a.Q3)("",!0)])])}),128))])])):s.loading||s.error?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("p",se,"暂无日志（确认 Edge Agent 已启动并产生日志）。")),s.resp?((0,a.uX)(),(0,a.CE)("div",ue,[(0,a.Lk)("button",{onClick:n[5]||(n[5]=function(){return u.prev&&u.prev.apply(u,arguments)}),disabled:s.loading||s.page<=1},"上一页",8,ie),(0,a.Lk)("button",{onClick:n[6]||(n[6]=function(){return u.next&&u.next.apply(u,arguments)}),disabled:s.loading||s.page>=(s.resp.TotalPages||1)},"下一页",8,ce)])):(0,a.Q3)("",!0)])}r(4346),r(3288),r(8781),r(7764),r(2953),r(8408),r(4603),r(7566),r(8721);const pe={name:"LogsView",data:function(){return{loading:!1,error:"",levels:[],level:"",keyword:"",page:1,pageSize:100,resp:null}},computed:{rows:function(){var e;return(null===(e=this.resp)||void 0===e?void 0:e.Data)||[]}},mounted:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){return(0,_.A)().w(function(n){while(1)switch(n.n){case 0:return n.n=1,e.loadLevels();case 1:return n.n=2,e.load();case 2:return n.a(2)}},n)}))()},methods:{loadLevels:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){var r;return(0,_.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return n.p=0,n.n=1,C("/edge/api/logs/levels");case 1:r=n.v,e.levels=Array.isArray(r)?r:[],n.n=3;break;case 2:n.p=2,n.v,e.levels=[];case 3:return n.a(2)}},n,null,[[0,2]])}))()},load:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){var r,l;return(0,_.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return e.loading=!0,e.error="",n.p=1,r=new URLSearchParams,e.level&&r.set("level",e.level),e.keyword&&r.set("keyword",e.keyword),r.set("page",String(e.page)),r.set("pageSize",String(e.pageSize)),n.n=2,C("/edge/api/logs?".concat(r.toString()));case 2:e.resp=n.v,n.n=4;break;case 3:n.p=3,l=n.v,e.error=(null===l||void 0===l?void 0:l.message)||String(l),e.resp=null;case 4:return n.p=4,e.loading=!1,n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])}))()},prev:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){return(0,_.A)().w(function(n){while(1)switch(n.n){case 0:if(!(e.page<=1)){n.n=1;break}return n.a(2);case 1:return e.page-=1,n.n=2,e.load();case 2:return n.a(2)}},n)}))()},next:function(){var e=this;return(0,A.A)((0,_.A)().m(function n(){var r,l;return(0,_.A)().w(function(n){while(1)switch(n.n){case 0:if(l=(null===(r=e.resp)||void 0===r?void 0:r.TotalPages)||1,!(e.page>=l)){n.n=1;break}return n.a(2);case 1:return e.page+=1,n.n=2,e.load();case 2:return n.a(2)}},n)}))()}}},ve=(0,i.A)(pe,[["render",de],["__scopeId","data-v-f9c97964"]]),ke=ve;var ge=[{path:"/",redirect:"/edges"},{path:"/edges",name:"edges",component:S},{path:"/metrics",name:"metrics",component:q},{path:"/logs",name:"logs",component:ke}];const Le=(0,v.aE)({history:(0,v.LA)(),routes:ge});(0,l.Ef)(p).use(Le).mount("#app")}},n={};function r(l){var t=n[l];if(void 0!==t)return t.exports;var a=n[l]={exports:{}};return e[l].call(a.exports,a,a.exports,r),a.exports}r.m=e,(()=>{var e=[];r.O=(n,l,t,a)=>{if(!l){var o=1/0;for(c=0;c<e.length;c++){for(var[l,t,a]=e[c],s=!0,u=0;u<l.length;u++)(!1&a||o>=a)&&Object.keys(r.O).every(e=>r.O[e](l[u]))?l.splice(u--,1):(s=!1,a<o&&(o=a));if(s){e.splice(c--,1);var i=t();void 0!==i&&(n=i)}}return n}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[l,t,a]}})(),(()=>{r.n=e=>{var n=e&&e.__esModule?()=>e["default"]:()=>e;return r.d(n,{a:n}),n}})(),(()=>{r.d=(e,n)=>{for(var l in n)r.o(n,l)&&!r.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:n[l]})}})(),(()=>{r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{r.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n)})(),(()=>{var e={524:0};r.O.j=n=>0===e[n];var n=(n,l)=>{var t,a,[o,s,u]=l,i=0;if(o.some(n=>0!==e[n])){for(t in s)r.o(s,t)&&(r.m[t]=s[t]);if(u)var c=u(r)}for(n&&n(l);i<o.length;i++)a=o[i],r.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return r.O(c)},l=self["webpackChunkdataacquisition_frontend"]=self["webpackChunkdataacquisition_frontend"]||[];l.forEach(n.bind(null,0)),l.push=n.bind(null,l.push.bind(l))})();var l=r.O(void 0,[504],()=>r(1133));l=r.O(l)})();
//# sourceMappingURL=app.7769bbe7.js.map
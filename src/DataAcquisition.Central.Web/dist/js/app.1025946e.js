(()=>{"use strict";var e={4066(e,t,n){n(3792),n(3362),n(9085),n(9391);var a=n(5130),r=n(9258),l=n(6768),s={class:"nav"},o={class:"main"};function i(e,t){var n=(0,l.g2)("router-link"),a=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.Lk)("nav",s,[(0,l.bF)(n,{to:"/edges"},{default:(0,l.k6)(function(){return(0,r.A)(t[0]||(t[0]=[(0,l.eW)("Edges",-1)]))}),_:1}),(0,l.bF)(n,{to:"/metrics"},{default:(0,l.k6)(function(){return(0,r.A)(t[1]||(t[1]=[(0,l.eW)("Edge Metrics",-1)]))}),_:1}),(0,l.bF)(n,{to:"/logs"},{default:(0,l.k6)(function(){return(0,r.A)(t[2]||(t[2]=[(0,l.eW)("Edge Logs",-1)]))}),_:1}),t[3]||(t[3]=(0,l.Lk)("a",{href:"/metrics",target:"_blank",rel:"noreferrer"},"Central /metrics",-1))]),(0,l.Lk)("main",o,[(0,l.bF)(a)])])}var d=n(1241);const u={},c=(0,d.A)(u,[["render",i],["__scopeId","data-v-16d294ee"]]),g=c;var p=n(8728),v=n(4232),k={class:"page"},f={class:"header"},h=["disabled"],L={key:0,class:"error"},m={key:1,class:"table"},b={class:"urlcell"},y={key:0},w={key:1},_={class:"errcell"},C={class:"actioncell"},A={key:2,class:"empty"};function I(e,t,n,a,s,o){var i=(0,l.g2)("router-link");return(0,l.uX)(),(0,l.CE)("div",k,[(0,l.Lk)("header",f,[t[1]||(t[1]=(0,l.Lk)("h1",null,"边缘节点（edge_id）",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=function(){return o.load&&o.load.apply(o,arguments)}),disabled:s.loading},(0,v.v_)(s.loading?"刷新中...":"刷新"),9,h)]),t[6]||(t[6]=(0,l.Lk)("p",{class:"hint"},[(0,l.eW)(" 后端："),(0,l.Lk)("code",null,"DataAcquisition.Central.Web"),(0,l.eW)("（默认 "),(0,l.Lk)("code",null,"http://localhost:8000"),(0,l.eW)("）； 前端 devServer 通过代理访问 "),(0,l.Lk)("code",null,"/api"),(0,l.eW)("。 ")],-1)),s.error?((0,l.uX)(),(0,l.CE)("p",L,(0,v.v_)(s.error),1)):(0,l.Q3)("",!0),s.edges.length?((0,l.uX)(),(0,l.CE)("table",m,[t[5]||(t[5]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"edge_id"),(0,l.Lk)("th",null,"agent_base_url"),(0,l.Lk)("th",null,"hostname"),(0,l.Lk)("th",null,"version"),(0,l.Lk)("th",null,"last_seen_utc"),(0,l.Lk)("th",null,"buffer_backlog"),(0,l.Lk)("th",null,"last_error"),(0,l.Lk)("th",null,"actions")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.edges,function(e){var n;return(0,l.uX)(),(0,l.CE)("tr",{key:e.edgeId},[(0,l.Lk)("td",null,[(0,l.Lk)("code",null,(0,v.v_)(e.edgeId),1)]),(0,l.Lk)("td",b,[e.agentBaseUrl?((0,l.uX)(),(0,l.CE)("code",y,(0,v.v_)(e.agentBaseUrl),1)):((0,l.uX)(),(0,l.CE)("span",w,"-"))]),(0,l.Lk)("td",null,(0,v.v_)(e.hostname||"-"),1),(0,l.Lk)("td",null,(0,v.v_)(e.version||"-"),1),(0,l.Lk)("td",null,(0,v.v_)(e.lastSeenUtc),1),(0,l.Lk)("td",null,(0,v.v_)(null!==(n=e.bufferBacklog)&&void 0!==n?n:"-"),1),(0,l.Lk)("td",_,(0,v.v_)(e.lastError||"-"),1),(0,l.Lk)("td",C,[(0,l.bF)(i,{to:{path:"/metrics",query:{edgeId:e.edgeId}}},{default:(0,l.k6)(function(){return(0,r.A)(t[2]||(t[2]=[(0,l.eW)("Metrics",-1)]))}),_:1},8,["to"]),t[4]||(t[4]=(0,l.Lk)("span",{class:"sep"},"|",-1)),(0,l.bF)(i,{to:{path:"/logs",query:{edgeId:e.edgeId}}},{default:(0,l.k6)(function(){return(0,r.A)(t[3]||(t[3]=[(0,l.eW)("Logs",-1)]))}),_:1},8,["to"])])])}),128))])])):s.loading||s.error?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("p",A,"暂无边缘节点（先调用 /api/edges/register 或 /api/edges/heartbeat）。"))])}var E=n(908),X=n(388);n(6280),n(6918),n(8706),n(6099);function x(e){return F.apply(this,arguments)}function F(){return F=(0,X.A)((0,E.A)().m(function e(t){var n,a;return(0,E.A)().w(function(e){while(1)switch(e.n){case 0:return e.n=1,fetch(t,{headers:{Accept:"application/json"}});case 1:if(n=e.v,n.ok){e.n=3;break}return e.n=2,n.text()["catch"](function(){return""});case 2:throw a=e.v,new Error("HTTP ".concat(n.status," ").concat(n.statusText).concat(a?": ".concat(a):""));case 3:return e.n=4,n.json();case 4:return e.a(2,e.v)}},e)})),F.apply(this,arguments)}const S={name:"EdgesView",data:function(){return{edges:[],loading:!1,error:""}},mounted:function(){this.load()},methods:{load:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n;return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return e.loading=!0,e.error="",t.p=1,t.n=2,x("/api/edges");case 2:e.edges=t.v,t.n=4;break;case 3:t.p=3,n=t.v,e.error=(null===n||void 0===n?void 0:n.message)||String(n);case 4:return t.p=4,e.loading=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}))()}}},U=(0,d.A)(S,[["render",I],["__scopeId","data-v-0b794a51"]]),P=U;n(739),n(3110);var N={class:"page"},O={class:"header"},V={class:"actions"},W=["disabled"],M={class:"card"},q={class:"row"},Q=["disabled"],j=["value"],R={class:"meta"},T={key:0},z={key:1},K={key:0,class:"error"},D={key:1,class:"grid"},H={class:"kpi"},$={class:"kpiValue"},B={class:"kpi"},J={class:"kpiValue"},Y={class:"kpi"},G={class:"kpiValue"},Z={class:"kpi"},ee={class:"kpiValue"},te={key:2,class:"card"},ne={class:"row"},ae={key:0,class:"table"},re={class:"labels"},le={key:0},se={key:1},oe={key:1,class:"empty"};function ie(e,t,n,r,s,o){return(0,l.uX)(),(0,l.CE)("div",N,[(0,l.Lk)("header",O,[t[4]||(t[4]=(0,l.Lk)("div",null,[(0,l.Lk)("h1",null,"Metrics（按 edge 下钻）"),(0,l.Lk)("p",{class:"sub"},[(0,l.eW)(" 通过 "),(0,l.Lk)("code",null,"/api/edges/<edgeId>/metrics/json"),(0,l.eW)(" 代理读取 Edge.Agent 的 "),(0,l.Lk)("code",null,"/metrics"),(0,l.eW)("。 ")])],-1)),(0,l.Lk)("div",V,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=function(){return o.reload&&o.reload.apply(o,arguments)}),disabled:s.loading||!s.edgeId},(0,v.v_)(s.loading?"刷新中...":"刷新"),9,W)])]),(0,l.Lk)("section",M,[(0,l.Lk)("div",q,[t[6]||(t[6]=(0,l.Lk)("label",{class:"label"},"选择 edge",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return s.edgeId=e}),onChange:t[2]||(t[2]=function(){return o.onEdgeChange&&o.onEdgeChange.apply(o,arguments)}),disabled:s.edgesLoading||0===s.edges.length},[t[5]||(t[5]=(0,l.Lk)("option",{value:"",disabled:""},"请选择…",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.edges,function(e){return(0,l.uX)(),(0,l.CE)("option",{key:e.edgeId,value:e.edgeId},(0,v.v_)(e.edgeId)+(0,v.v_)(e.hostname?" (".concat(e.hostname,")"):""),9,j)}),128))],40,Q),[[a.u1,s.edgeId]])]),(0,l.Lk)("div",R,[s.lastUpdate?((0,l.uX)(),(0,l.CE)("span",T,"最后更新："+(0,v.v_)(s.lastUpdate),1)):s.loading?((0,l.uX)(),(0,l.CE)("span",z,"正在加载…")):(0,l.Q3)("",!0)])]),s.error?((0,l.uX)(),(0,l.CE)("p",K,(0,v.v_)(s.error),1)):(0,l.Q3)("",!0),s.edgeId&&s.metrics?((0,l.uX)(),(0,l.CE)("section",D,[(0,l.Lk)("div",H,[t[7]||(t[7]=(0,l.Lk)("div",{class:"kpiLabel"},"采集延迟",-1)),(0,l.Lk)("div",$,(0,v.v_)(o.fmtNum(o.getOne("data_acquisition_collection_latency_ms")))+" ms",1)]),(0,l.Lk)("div",B,[t[8]||(t[8]=(0,l.Lk)("div",{class:"kpiLabel"},"采集频率",-1)),(0,l.Lk)("div",J,(0,v.v_)(o.fmtNum(o.getOne("data_acquisition_collection_rate")))+" points/s",1)]),(0,l.Lk)("div",Y,[t[9]||(t[9]=(0,l.Lk)("div",{class:"kpiLabel"},"队列深度",-1)),(0,l.Lk)("div",G,(0,v.v_)(o.fmtNum(o.getOne("data_acquisition_queue_depth"))),1)]),(0,l.Lk)("div",Z,[t[10]||(t[10]=(0,l.Lk)("div",{class:"kpiLabel"},"错误总数",-1)),(0,l.Lk)("div",ee,(0,v.v_)(o.fmtNum(o.getOne("data_acquisition_errors_total"))),1)])])):(0,l.Q3)("",!0),s.edgeId&&s.metrics?((0,l.uX)(),(0,l.CE)("section",te,[(0,l.Lk)("div",ne,[t[11]||(t[11]=(0,l.Lk)("label",{class:"label"},"搜索指标",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return s.keyword=e}),placeholder:"按指标名过滤…"},null,512),[[a.Jo,s.keyword]])]),o.filteredMetricNames.length?((0,l.uX)(),(0,l.CE)("table",ae,[t[12]||(t[12]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"metric"),(0,l.Lk)("th",null,"type"),(0,l.Lk)("th",null,"latest"),(0,l.Lk)("th",null,"labels")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.filteredMetricNames,function(e){var t,n,a,r;return(0,l.uX)(),(0,l.CE)("tr",{key:e},[(0,l.Lk)("td",null,[(0,l.Lk)("code",null,(0,v.v_)(e),1)]),(0,l.Lk)("td",null,(0,v.v_)((null===(t=s.metrics[e])||void 0===t?void 0:t.type)||"-"),1),(0,l.Lk)("td",null,(0,v.v_)(o.fmtLatest(null===(n=s.metrics[e])||void 0===n?void 0:n.data)),1),(0,l.Lk)("td",re,[o.latestLabels(null===(a=s.metrics[e])||void 0===a?void 0:a.data)?((0,l.uX)(),(0,l.CE)("span",le,[(0,l.Lk)("code",null,(0,v.v_)(JSON.stringify(o.latestLabels(null===(r=s.metrics[e])||void 0===r?void 0:r.data))),1)])):((0,l.uX)(),(0,l.CE)("span",se,"-"))])])}),128))])])):((0,l.uX)(),(0,l.CE)("p",oe,"暂无指标数据（或该 edge 不可达）。"))])):(0,l.Q3)("",!0)])}n(2008),n(4423),n(4346),n(6910),n(9089),n(3288),n(8111),n(2489),n(2892),n(5428),n(9868),n(9432),n(7495),n(1699),n(5440),n(2762);const de={name:"MetricsView",data:function(){return{edgesLoading:!1,edges:[],edgeId:"",loading:!1,error:"",lastUpdate:"",metrics:null,keyword:""}},computed:{filteredMetricNames:function(){var e=this.metrics?Object.keys(this.metrics):[],t=(this.keyword||"").trim().toLowerCase(),n=t?e.filter(function(e){return e.toLowerCase().includes(t)}):e;return n.sort()}},mounted:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n,a;return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.loadEdges();case 1:if(a=null===(n=e.$route)||void 0===n||null===(n=n.query)||void 0===n?void 0:n.edgeId,"string"===typeof a&&a?e.edgeId=a:e.edges.length&&(e.edgeId=e.edges[0].edgeId),!e.edgeId){t.n=2;break}return t.n=2,e.loadMetrics();case 2:return t.a(2)}},t)}))()},methods:{loadEdges:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n;return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return e.edgesLoading=!0,t.p=1,t.n=2,x("/api/edges");case 2:e.edges=t.v,t.n=4;break;case 3:t.p=3,n=t.v,e.error=(null===n||void 0===n?void 0:n.message)||String(n);case 4:return t.p=4,e.edgesLoading=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}))()},loadMetrics:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n,a;return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(e.edgeId){t.n=1;break}return t.a(2);case 1:return e.loading=!0,e.error="",t.p=2,t.n=3,x("/api/edges/".concat(encodeURIComponent(e.edgeId),"/metrics/json"));case 3:n=t.v,e.metrics=n.metrics||{},e.lastUpdate=new Date(n.timestamp||Date.now()).toLocaleString("zh-CN"),t.n=5;break;case 4:t.p=4,a=t.v,e.metrics=null,e.error=(null===a||void 0===a?void 0:a.message)||String(a);case 5:return t.p=5,e.loading=!1,t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}))()},onEdgeChange:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return e.$router.replace({path:"/metrics",query:{edgeId:e.edgeId}})["catch"](function(){}),t.n=1,e.loadMetrics();case 1:return t.a(2)}},t)}))()},reload:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.loadMetrics();case 1:return t.a(2)}},t)}))()},latestPoint:function(e){return Array.isArray(e)&&0!==e.length?e[e.length-1]:null},latestLabels:function(e){var t=this.latestPoint(e);return t&&t.labels?t.labels:null},fmtLatest:function(e){var t=this.latestPoint(e);if(!t)return"-";var n="number"===typeof t.value?t.value:Number(t.value);return Number.isFinite(n)?this.fmtNum(n):String(t.value)},fmtNum:function(e){var t="number"===typeof e?e:Number(e);return Number.isFinite(t)?t.toFixed(2):"-"},getOne:function(e){var t=this.metrics?this.metrics[e]:null,n=t?this.latestPoint(t.data):null;return n?n.value:null}}},ue=(0,d.A)(de,[["render",ie],["__scopeId","data-v-23c06814"]]),ce=ue;var ge={class:"page"},pe={class:"header"},ve={class:"actions"},ke={class:"chk"},fe=["disabled"],he={class:"card"},Le={class:"row"},me=["disabled"],be=["value"],ye=["disabled"],we=["value"],_e=["disabled"],Ce=["disabled"],Ae=["disabled"],Ie={class:"meta"},Ee={key:0},Xe={key:1,style:{"margin-left":"12px"}},xe={key:0,class:"error"},Fe={key:1,class:"stats"},Se={class:"stat"},Ue={class:"statValue info"},Pe={class:"stat"},Ne={class:"statValue warn"},Oe={class:"stat"},Ve={class:"statValue err"},We={key:2,class:"card"},Me={key:0,class:"loading"},qe={key:1,class:"empty"},Qe={key:2},je=["data-level"],Re={class:"logHead"},Te={class:"ts"},ze=["data-lvl"],Ke={key:0,class:"src"},De={class:"msg"},He={key:0,class:"ex"},$e=["onClick"],Be={key:0,class:"exbox"},Je={class:"pager"},Ye=["disabled"],Ge={class:"pmeta"},Ze=["disabled"],et=["disabled"];function tt(e,t,n,s,o,i){return(0,l.uX)(),(0,l.CE)("div",ge,[(0,l.Lk)("header",pe,[t[16]||(t[16]=(0,l.Lk)("div",null,[(0,l.Lk)("h1",null,"Logs（按 edge 下钻）"),(0,l.Lk)("p",{class:"sub"},[(0,l.eW)("通过 "),(0,l.Lk)("code",null,"/api/edges/<edgeId>/logs"),(0,l.eW)(" 代理读取 Edge.Agent 日志。")])],-1)),(0,l.Lk)("div",ve,[(0,l.Lk)("label",ke,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=function(e){return o.autoRefresh=e}),onChange:t[1]||(t[1]=function(){return i.toggleAutoRefresh&&i.toggleAutoRefresh.apply(i,arguments)})},null,544),[[a.lH,o.autoRefresh]]),t[15]||(t[15]=(0,l.eW)(" 自动刷新（1s） ",-1))]),(0,l.Lk)("button",{onClick:t[2]||(t[2]=function(){return i.reload&&i.reload.apply(i,arguments)}),disabled:o.loading||!o.edgeId},(0,v.v_)(o.loading?"刷新中...":"刷新"),9,fe)])]),(0,l.Lk)("section",he,[(0,l.Lk)("div",Le,[t[19]||(t[19]=(0,l.Lk)("label",{class:"label"},"选择 edge",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return o.edgeId=e}),onChange:t[4]||(t[4]=function(){return i.onEdgeChange&&i.onEdgeChange.apply(i,arguments)}),disabled:o.edgesLoading||0===o.edges.length},[t[17]||(t[17]=(0,l.Lk)("option",{value:"",disabled:""},"请选择…",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.edges,function(e){return(0,l.uX)(),(0,l.CE)("option",{key:e.edgeId,value:e.edgeId},(0,v.v_)(e.edgeId)+(0,v.v_)(e.hostname?" (".concat(e.hostname,")"):""),9,be)}),128))],40,me),[[a.u1,o.edgeId]]),t[20]||(t[20]=(0,l.Lk)("label",{class:"label",style:{"margin-left":"14px"}},"Level",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.level=e}),onChange:t[6]||(t[6]=function(){return i.applyFilters&&i.applyFilters.apply(i,arguments)}),disabled:!o.edgeId},[t[18]||(t[18]=(0,l.Lk)("option",{value:""},"全部",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.levels,function(e){return(0,l.uX)(),(0,l.CE)("option",{key:e,value:e},(0,v.v_)(e),9,we)}),128))],40,ye),[[a.u1,o.level]]),t[21]||(t[21]=(0,l.Lk)("label",{class:"label",style:{"margin-left":"14px"}},"关键字",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=function(e){return o.keyword=e}),onKeyup:t[8]||(t[8]=(0,a.jR)(function(){return i.applyFilters&&i.applyFilters.apply(i,arguments)},["enter"])),placeholder:"消息/源/异常…",disabled:!o.edgeId},null,40,_e),[[a.Jo,o.keyword]]),(0,l.Lk)("button",{onClick:t[9]||(t[9]=function(){return i.applyFilters&&i.applyFilters.apply(i,arguments)}),disabled:o.loading||!o.edgeId},"搜索",8,Ce),(0,l.Lk)("button",{onClick:t[10]||(t[10]=function(){return i.clearFilters&&i.clearFilters.apply(i,arguments)}),disabled:o.loading||!o.edgeId},"清空",8,Ae)]),(0,l.Lk)("div",Ie,[o.lastUpdate?((0,l.uX)(),(0,l.CE)("span",Ee,"最后更新："+(0,v.v_)(o.lastUpdate),1)):(0,l.Q3)("",!0),o.total>0?((0,l.uX)(),(0,l.CE)("span",Xe,"共 "+(0,v.v_)(o.total)+" 条",1)):(0,l.Q3)("",!0)])]),o.error?((0,l.uX)(),(0,l.CE)("p",xe,(0,v.v_)(o.error),1)):(0,l.Q3)("",!0),o.edgeId&&o.total>0?((0,l.uX)(),(0,l.CE)("section",Fe,[(0,l.Lk)("div",Se,[t[22]||(t[22]=(0,l.Lk)("div",{class:"statLabel"},"本页 Information",-1)),(0,l.Lk)("div",Ue,(0,v.v_)(i.stats.information),1)]),(0,l.Lk)("div",Pe,[t[23]||(t[23]=(0,l.Lk)("div",{class:"statLabel"},"本页 Warning",-1)),(0,l.Lk)("div",Ne,(0,v.v_)(i.stats.warning),1)]),(0,l.Lk)("div",Oe,[t[24]||(t[24]=(0,l.Lk)("div",{class:"statLabel"},"本页 Error/Fatal",-1)),(0,l.Lk)("div",Ve,(0,v.v_)(i.stats.error),1)])])):(0,l.Q3)("",!0),o.edgeId?((0,l.uX)(),(0,l.CE)("section",We,[o.loading&&0===o.logs.length?((0,l.uX)(),(0,l.CE)("div",Me,"正在加载日志…")):0===o.logs.length?((0,l.uX)(),(0,l.CE)("div",qe,"暂无日志数据")):((0,l.uX)(),(0,l.CE)("div",Qe,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.logs,function(e,t){return(0,l.uX)(),(0,l.CE)("div",{key:t,class:"log","data-level":(e.level||"").toLowerCase()},[(0,l.Lk)("div",Re,[(0,l.Lk)("span",Te,(0,v.v_)(i.fmtTs(e.timestamp)),1),(0,l.Lk)("span",{class:"lvl","data-lvl":(e.level||"").toLowerCase()},(0,v.v_)(e.level),9,ze),e.source?((0,l.uX)(),(0,l.CE)("span",Ke,(0,v.v_)(e.source),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",De,(0,v.v_)(e.message),1),e.exception?((0,l.uX)(),(0,l.CE)("div",He,[(0,l.Lk)("button",{class:"toggle",onClick:function(e){return i.toggleEx(t)}},(0,v.v_)(o.expanded[t]?"隐藏异常":"显示异常"),9,$e),o.expanded[t]?((0,l.uX)(),(0,l.CE)("pre",Be,(0,v.v_)(e.exception),1)):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)],8,je)}),128)),(0,l.Lk)("div",Je,[(0,l.Lk)("button",{onClick:t[11]||(t[11]=function(){return i.prevPage&&i.prevPage.apply(i,arguments)}),disabled:o.page<=1||o.loading},"上一页",8,Ye),(0,l.Lk)("span",Ge,"第 "+(0,v.v_)(o.page)+" / "+(0,v.v_)(o.totalPages)+" 页",1),(0,l.Lk)("button",{onClick:t[12]||(t[12]=function(){return i.nextPage&&i.nextPage.apply(i,arguments)}),disabled:o.page>=o.totalPages||o.loading},"下一页",8,Ze),t[26]||(t[26]=(0,l.Lk)("span",{style:{"margin-left":"16px"}},"每页",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=function(e){return o.pageSize=e}),onChange:t[14]||(t[14]=function(){return i.applyFilters&&i.applyFilters.apply(i,arguments)}),disabled:o.loading},(0,r.A)(t[25]||(t[25]=[(0,l.Lk)("option",{value:50},"50",-1),(0,l.Lk)("option",{value:100},"100",-1),(0,l.Lk)("option",{value:200},"200",-1),(0,l.Lk)("option",{value:500},"500",-1)])),40,et),[[a.u1,o.pageSize,void 0,{number:!0}]])])]))])):(0,l.Q3)("",!0)])}var nt=n(8653),at=n(3604);n(150),n(8781),n(7764),n(8156),n(2953),n(6031),n(8408),n(4603),n(7566),n(8721);const rt={name:"LogsView",data:function(){return{edgesLoading:!1,edges:[],edgeId:"",levels:[],level:"",keyword:"",logs:[],total:0,page:1,pageSize:100,totalPages:1,loading:!1,error:"",lastUpdate:"",autoRefresh:!1,timer:null,expanded:{}}},computed:{stats:function(){var e,t={information:0,warning:0,error:0},n=(0,at.A)(this.logs);try{for(n.s();!(e=n.n()).done;){var a=e.value,r=(a.level||"").toLowerCase();"information"===r?t.information+=1:"warning"===r?t.warning+=1:"error"!==r&&"fatal"!==r||(t.error+=1)}}catch(l){n.e(l)}finally{n.f()}return t}},mounted:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n,a;return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.loadEdges();case 1:if(a=null===(n=e.$route)||void 0===n||null===(n=n.query)||void 0===n?void 0:n.edgeId,"string"===typeof a&&a?e.edgeId=a:e.edges.length&&(e.edgeId=e.edges[0].edgeId),!e.edgeId){t.n=3;break}return t.n=2,e.loadLevels();case 2:return t.n=3,e.loadLogs();case 3:return t.a(2)}},t)}))()},beforeUnmount:function(){this.timer&&clearInterval(this.timer)},methods:{loadEdges:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n;return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return e.edgesLoading=!0,t.p=1,t.n=2,x("/api/edges");case 2:e.edges=t.v,t.n=4;break;case 3:t.p=3,n=t.v,e.error=(null===n||void 0===n?void 0:n.message)||String(n);case 4:return t.p=4,e.edgesLoading=!1,t.f(4);case 5:return t.a(2)}},t,null,[[1,3,4,5]])}))()},loadLevels:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(e.edgeId){t.n=1;break}return t.a(2);case 1:return t.p=1,t.n=2,x("/api/edges/".concat(encodeURIComponent(e.edgeId),"/logs/levels"));case 2:e.levels=t.v,t.n=4;break;case 3:t.p=3,t.v,e.levels=[];case 4:return t.a(2)}},t,null,[[1,3]])}))()},loadLogs:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){var n,a,r;return(0,E.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(e.edgeId){t.n=1;break}return t.a(2);case 1:return e.loading=!0,e.error="",t.p=2,n=new URLSearchParams({page:String(e.page),pageSize:String(e.pageSize)}),e.level&&n.set("level",e.level),e.keyword&&n.set("keyword",e.keyword),t.n=3,x("/api/edges/".concat(encodeURIComponent(e.edgeId),"/logs?").concat(n.toString()));case 3:a=t.v,e.logs=a.data||[],e.total=a.total||0,e.totalPages=a.totalPages||1,e.lastUpdate=(new Date).toLocaleString("zh-CN"),e.expanded={},t.n=5;break;case 4:t.p=4,r=t.v,e.logs=[],e.total=0,e.totalPages=1,e.error=(null===r||void 0===r?void 0:r.message)||String(r);case 5:return t.p=5,e.loading=!1,t.f(5);case 6:return t.a(2)}},t,null,[[2,4,5,6]])}))()},onEdgeChange:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return e.$router.replace({path:"/logs",query:{edgeId:e.edgeId}})["catch"](function(){}),e.page=1,e.level="",e.keyword="",t.n=1,e.loadLevels();case 1:return t.n=2,e.loadLogs();case 2:return t.a(2)}},t)}))()},applyFilters:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return e.page=1,t.n=1,e.loadLogs();case 1:return t.a(2)}},t)}))()},clearFilters:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return e.level="",e.keyword="",e.page=1,t.n=1,e.loadLogs();case 1:return t.a(2)}},t)}))()},reload:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:return t.n=1,e.loadLogs();case 1:return t.a(2)}},t)}))()},toggleEx:function(e){this.expanded[e]=!this.expanded[e],this.expanded=(0,nt.A)({},this.expanded)},fmtTs:function(e){if(!e)return"";var t=new Date(e);if(Number.isNaN(t.getTime()))return String(e);var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return String(e).padStart(t,"0")};return"".concat(t.getFullYear(),"-").concat(n(t.getMonth()+1),"-").concat(n(t.getDate())," ").concat(n(t.getHours()),":").concat(n(t.getMinutes()),":").concat(n(t.getSeconds()),".").concat(n(t.getMilliseconds(),3))},prevPage:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:if(!(e.page<=1)){t.n=1;break}return t.a(2);case 1:return e.page-=1,t.n=2,e.loadLogs();case 2:window.scrollTo({top:0,behavior:"smooth"});case 3:return t.a(2)}},t)}))()},nextPage:function(){var e=this;return(0,X.A)((0,E.A)().m(function t(){return(0,E.A)().w(function(t){while(1)switch(t.n){case 0:if(!(e.page>=e.totalPages)){t.n=1;break}return t.a(2);case 1:return e.page+=1,t.n=2,e.loadLogs();case 2:window.scrollTo({top:0,behavior:"smooth"});case 3:return t.a(2)}},t)}))()},toggleAutoRefresh:function(){var e=this;this.autoRefresh?(this.timer&&clearInterval(this.timer),this.timer=setInterval(function(){return e.loadLogs()},1e3)):(this.timer&&clearInterval(this.timer),this.timer=null)}}},lt=(0,d.A)(rt,[["render",tt],["__scopeId","data-v-25072fae"]]),st=lt;var ot=[{path:"/",redirect:"/edges"},{path:"/edges",name:"edges",component:P},{path:"/metrics",name:"metrics",component:ce},{path:"/logs",name:"logs",component:st}];const it=(0,p.aE)({history:(0,p.LA)(),routes:ot});(0,a.Ef)(g).use(it).mount("#app")}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var l=t[a]={exports:{}};return e[a].call(l.exports,l,l.exports,n),l.exports}n.m=e,(()=>{var e=[];n.O=(t,a,r,l)=>{if(!a){var s=1/0;for(u=0;u<e.length;u++){for(var[a,r,l]=e[u],o=!0,i=0;i<a.length;i++)(!1&l||s>=l)&&Object.keys(n.O).every(e=>n.O[e](a[i]))?a.splice(i--,1):(o=!1,l<s&&(s=l));if(o){e.splice(u--,1);var d=r();void 0!==d&&(t=d)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[a,r,l]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{var e={524:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var r,l,[s,o,i]=a,d=0;if(s.some(t=>0!==e[t])){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(i)var u=i(n)}for(t&&t(a);d<s.length;d++)l=s[d],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},a=self["webpackChunkdataacquisition_frontend"]=self["webpackChunkdataacquisition_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var a=n.O(void 0,[504],()=>n(4066));a=n.O(a)})();
//# sourceMappingURL=app.1025946e.js.map